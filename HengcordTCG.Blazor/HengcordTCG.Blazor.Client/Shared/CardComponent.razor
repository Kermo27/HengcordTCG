@using HengcordTCG.Shared.Models
@using ModelCard = HengcordTCG.Shared.Models.Card

<div @onclick="OnClick" class="group relative cursor-pointer">
    <div class="relative aspect-[3/4] rounded-xl overflow-hidden border-2 transition-all duration-300 @GetBorderClass() @GetHoverClass()">
        <!-- Card Background -->
        @if (!string.IsNullOrEmpty(Card.ImagePath))
        {
            <img src="/api/images/@Card.ImagePath" alt="@Card.Name" 
                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105" />
        }
        else
        {
            <div class="w-full h-full bg-gradient-to-br @GetRarityGradient() flex items-center justify-center">
                <i class="fa fa-image text-white/30 text-4xl"></i>
            </div>
        }
        
        <!-- Rarity Badge -->
        <div class="absolute top-2 right-2">
            <span class="@GetRarityBadgeClass() text-xs font-bold px-2 py-1 rounded">
                @Card.Rarity
            </span>
        </div>

        <!-- Count Badge -->
        @if (Count > 1)
        {
            <div class="absolute top-2 left-2">
                <span class="bg-slate-900/80 text-white border-0 px-2 py-1 rounded text-xs">
                    x@Count
                </span>
            </div>
        }

        <!-- Card Info Overlay -->
        <div class="absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/90 via-black/50 to-transparent">
            <h3 class="font-semibold text-white text-sm truncate">@Card.Name</h3>
            <div class="flex items-center gap-3 mt-1 text-xs">
                <span class="flex items-center text-red-400">
                    <i class="fa fa-khanda mr-1"></i>
                    @Card.Attack
                </span>
                <span class="flex items-center text-blue-400">
                    <i class="fa fa-shield-halved mr-1"></i>
                    @Card.Defense
                </span>
            </div>
        </div>

        <!-- Shine Effect -->
        @if (Card.Rarity == Rarity.Legendary)
        {
            <div class="absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        }
    </div>
</div>

@code {
    [Parameter] public ModelCard Card { get; set; } = default!;
    [Parameter] public int Count { get; set; } = 1;
    [Parameter] public EventCallback OnClick { get; set; }

    private string GetBorderClass() => Card.Rarity switch
    {
        Rarity.Legendary => "border-amber-500/50 shadow-lg shadow-amber-500/20",
        Rarity.Rare => "border-purple-500/50 shadow-lg shadow-purple-500/20",
        _ => "border-slate-700/50"
    };

    private string GetHoverClass() => Card.Rarity switch
    {
        Rarity.Legendary => "hover:border-amber-400 hover:shadow-amber-500/40",
        Rarity.Rare => "hover:border-purple-400 hover:shadow-purple-500/40",
        _ => "hover:border-slate-600"
    };

    private string GetRarityGradient() => Card.Rarity switch
    {
        Rarity.Legendary => "from-amber-600 to-orange-700",
        Rarity.Rare => "from-purple-600 to-blue-700",
        _ => "from-slate-600 to-slate-700"
    };

    private string GetRarityBadgeClass() => Card.Rarity switch
    {
        Rarity.Legendary => "border border-amber-500 text-amber-400 bg-amber-950/80",
        Rarity.Rare => "border border-purple-500 text-purple-400 bg-purple-950/80",
        _ => "border border-slate-500 text-slate-400 bg-slate-950/80"
    };
}
